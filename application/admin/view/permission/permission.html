{include file="header"}    <!--引入头部文件-->

{include file="left"}       <!-- 引入左侧导航栏文件-->
<section class="Hui-article-box">
    <nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 管理员管理 <span class="c-gray en">&gt;</span> 权限分类管理 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>
    <div class="Hui-article">
        <article class="cl pd-20">
            <div class="text-c">
                <div class="Huiform" method="post" action="" target="_self">
                    <input type="text" class="input-text" style="width:250px" placeholder="权限分类名称" id="name" >
                    <select  id="cateid">
                        {volist name="cate" id="vo"}

                        <option value="{$vo.id}">{$vo.name}</option>
                        {/volist}
                    </select>
                    <button type="submit" class="btn btn-success" id="aaa" name=""><i class="Hui-iconfont">&#xe600;</i> 添加权限分类</button>
                </div>
            </div>

            <table class="table table-border table-bordered table-bg">
                <thead>
                <tr>
                    <th scope="col" colspan="7">权限节点</th>
                </tr>
                <tr class="text-c">
                    <th width="25"><input type="checkbox" name="" value=""></th>
                    <th width="40">ID</th>
                    <th width="200">权限分类名称</th>
                    <th width="200">分类名称</th>
                    <th width="100">操作</th>
                </tr>
                </thead>
                <tbody>

                </tbody>
            </table>
        </article>
    </div>
</section>

{include file="foot"}       <!--引入底部导航栏文件-->
<script>
    $(document).ready(function(){
        show();

        $("#aaa").click(function(){
            var name=$("#name").val();
            var cateid=$("#cateid").val();
            $.ajax({
                type:'post',                             //ajax post传值
                url:"{:url('add')}",
                data:{
                    name:name,
                    cateid:cateid,
                    html_type:'json',
                },
                success:function (res) {
                    show();
                    $("#name").val("");


                }
            })

        });


    });

    function show(){
        $.ajax({
            type:'post',                             //ajax post传值
            url:"{:url('showa')}",
            data:{
                html_type:'json',
            },
            dataType:"json",
            success:function (res) {
                if (res.status=="error"){
                    alert(res.message)
                }else{
                    var status=res.status;
                    var message=res.message;
                    console.log(status)
                    var tr='';
                    if (status=='ok') {
                        for (var i=0; i < message.length; i++){
                            console.log(message[i].name);
                            tr=tr+"<tr class='text-c'><td><input type=\"checkbox\" name=\"\" value=\"\"></td><td>"+message[i].id+"</td><td class='text-l'>"+message[i].name+"</td><td>"+message[i].pc_name+"</td><td class='f-14 product-brand-manage'><a style='text-decoration:none'   title='编辑'><i class='Hui-iconfont'>&#xe6df;</i></a><a   style='text-decoration:none' onclick='del("+message[i].id+")' class='ml-5'  title='删除'><i class='Hui-iconfont'>&#xe6e2;</i></a></td></tr>"
                        }
                        $(".table tbody").html(tr);
                    }
                }
            }
        })
    }

    function del(del_id) {
        $.ajax({
            type:'post',
            url:"del",
            data:{
                del_id:del_id,
            },
            dataType:"json",
            success:function(res) {
                if (res.status=="ok") {
                   show();
                }
            }
        })
    }



</script>